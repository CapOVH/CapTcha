<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Dashboard – CapTcha Tool</title>

  <!-- Tailwind + Alpine -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>

  <!-- Feather Icons -->
  <script src="https://unpkg.com/feather-icons"></script>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>

  <style>
    body { font-family: 'Inter', sans-serif; }
    .glass { @apply bg-white/8 backdrop-blur-2xl border border-white/10 shadow-2xl; }
    .dark .glass { @apply bg-gray-900/70 border-gray-700/50; }
    .neon-glow { box-shadow: 0 0 20px rgba(99, 102, 241, 0.4); }
    .neon-glow:hover { box-shadow: 0 0 30px rgba(99, 102, 241, 0.6); }
    .sidebar { @apply fixed inset-y-0 left-0 w-72 bg-gradient-to-b from-indigo-900/20 to-purple-900/20 backdrop-blur-3xl border-r border-white/10 transition-all duration-300 z-50; }
    .sidebar.collapsed { @apply -translate-x-full lg:translate-x-0 lg:w-20; }
    .sidebar-item { @apply flex items-center space-x-3 p-3 rounded-xl transition-all duration-200 hover:bg-white/10 hover:neon-glow; }
    .sidebar-item.active { @apply bg-gradient-to-r from-indigo-500/20 to-purple-600/20 neon-glow; }
    .card-float { @apply transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl; }
    .badge-glow { @apply px-2 py-1 rounded-full text-xs font-medium animate-pulse; }
  </style>
</head>
<body class="bg-gradient-to-br from-gray-100 via-indigo-50 to-purple-50 dark:from-gray-900 dark:via-indigo-950 dark:to-purple-950 text-gray-900 dark:text-gray-100 min-h-screen" x-data="dashboard()" x-init="feather.replace(); initAuth()">

<!-- Collapsible Sidebar -->
<div class="sidebar glass" :class="{ 'collapsed': collapsed }">
  <div class="p-5">
    <!-- Logo & Collapse Button -->
    <div class="flex items-center justify-between mb-10">
      <a href="index.html" class="flex items-center space-x-3" :class="{ 'justify-center': collapsed }">
        <div class="w-12 h-12 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl flex items-center justify-center text-white text-xl font-bold shadow-lg neon-glow">CT</div>
        <span x-show="!collapsed" class="text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-indigo-400 to-purple-400">CapTcha</span>
      </a>
      <button @click="collapsed = !collapsed" class="lg:hidden p-2 rounded-lg hover:bg-white/10">
        <i data-feather="x" class="w-5 h-5"></i>
      </button>
    </div>

    <!-- Nav Items -->
    <nav class="space-y-2">
      <a href="dashboard.html" class="sidebar-item active">
        <i data-feather="airplay" class="w-5 h-5"></i>
        <span x-show="!collapsed">Dashboard</span>
        <span x-show="collapsed" class="tooltip" data-tip="Dashboard"></span>
      </a>

      <a href="#" class="sidebar-item">
        <i data-feather="save" class="w-5 h-5"></i>
        <span x-show="!collapsed">Configs</span>
        <span x-show="collapsed" class="tooltip" data-tip="Configs"></span>
      </a>

      <a href="#" class="sidebar-item">
        <i data-feather="code" class="w-5 h-5"></i>
        <span x-show="!collapsed">Scripts</span>
        <span x-show="collapsed" class="tooltip" data-tip="Scripts"></span>
      </a>

      <div x-data="{ open: true }">
        <button @click="open = !open" class="w-full sidebar-item">
          <i data-feather="key" class="w-5 h-5"></i>
          <span x-show="!collapsed" class="flex-1 text-left">Your Keys</span>
          <i :class="open ? 'rotate-90' : ''" data-feather="chevron-right" class="w-4 h-4 transition-transform" x-show="!collapsed"></i>
        </button>
        <div x-show="open && !collapsed" x-collapse class="pl-10 space-y-1">
          <a href="#" class="block p-2 text-sm text-gray-400 hover:text-white">View Keys</a>
        </div>
      </div>

      <hr class="my-4 border-white/10" x-show="!collapsed">

      <a href="#" class="sidebar-item" x-show="!collapsed">
        <i data-feather="file-text" class="w-5 h-5"></i>
        <span>Documentation</span>
        <span class="ml-auto badge-glow bg-yellow-500/20 text-yellow-300">new</span>
      </a>

      <a href="https://discord.gg/crackv" target="_blank" class="sidebar-item" x-show="!collapsed">
        <i class="fab fa-discord w-5 h-5"></i>
        <span>Discord</span>
      </a>
    </nav>

    <!-- Collapse Toggle (Desktop) -->
    <div class="mt-8" x-show="!collapsed">
      <button @click="collapsed = !collapsed" class="w-full flex items-center justify-center space-x-2 p-3 rounded-xl hover:bg-white/10 text-sm">
        <i data-feather="arrow-left-to-line" class="w-5 h-5"></i>
        <span>Collapse</span>
      </button>
    </div>
  </div>
</div>

<!-- Main Content -->
<main class="lg:ml-72 min-h-screen pt-20 px-6 pb-20 transition-all duration-300" :class="{ 'lg:ml-20': collapsed }">
  <div class="max-w-7xl mx-auto">

    <!-- Header -->
    <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between mb-10">
      <div>
        <h1 class="text-4xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-indigo-500 to-purple-600">Welcome Back</h1>
        <p class="text-lg text-gray-600 dark:text-gray-300">Hi, <span x-text="user?.email?.split('@')[0] || 'User'"></span> — ready to solve?</p>
      </div>
      <div class="flex flex-wrap gap-3 mt-4 lg:mt-0">
        <button @click="openRedeemModal = true" class="px-5 py-3 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl font-medium shadow-lg hover:shadow-xl neon-glow transition">
          <i data-feather="plus" class="w-5 h-5 inline mr-2"></i>Redeem Key
        </button>
        <button @click="copyInjectCode" class="px-5 py-3 border border-indigo-500 text-indigo-500 dark:text-indigo-400 rounded-xl font-medium hover:bg-indigo-50 dark:hover:bg-indigo-900/20 transition">
          <i data-feather="copy" class="w-5 h-5 inline mr-2"></i>Copy Inject
        </button>
        <button @click="logout()" class="px-5 py-3 bg-red-600 text-white rounded-xl font-medium hover:bg-red-700 transition">
          <i data-feather="log-out" class="w-5 h-5 inline mr-2"></i>Logout
        </button>
      </div>
    </div>

    <!-- Stats Cards -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-10">
      <div class="glass p-6 rounded-3xl card-float">
        <div class="flex items-center justify-between">
          <div class="flex items-center space-x-4">
            <div class="w-14 h-14 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl flex items-center justify-center shadow-lg neon-glow">
              <i data-feather="zap" class="w-7 h-7 text-white"></i>
            </div>
            <div>
              <p class="text-sm text-gray-600 dark:text-gray-400">Your Injections</p>
              <p class="text-3xl font-bold text-indigo-600 dark:text-indigo-400" x-text="stats.personal"></p>
            </div>
          </div>
          <span class="text-xs text-gray-500">Today</span>
        </div>
      </div>

      <div class="glass p-6 rounded-3xl card-float">
        <div class="flex items-center justify-between">
          <div class="flex items-center space-x-4">
            <div class="w-14 h-14 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-2xl flex items-center justify-center shadow-lg neon-glow">
              <i data-feather="globe" class="w-7 h-7 text-white"></i>
            </div>
            <div>
              <p class="text-sm text-gray-600 dark:text-gray-400">Global Injections</p>
              <p class="text-3xl font-bold text-cyan-600 dark:text-cyan-400" x-text="stats.global"></p>
            </div>
          </div>
          <span class="text-xs text-gray-500">Total</span>
        </div>
      </div>
    </div>

    <!-- Keys Table -->
    <div class="glass p-6 rounded-3xl card-float">
      <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6">
        <div>
          <h3 class="text-2xl font-bold">Your Keys</h3>
          <p class="text-sm text-gray-600 dark:text-gray-400">Manage and track all your access keys</p>
        </div>
        <input type="search" placeholder="Search keys..." class="mt-3 sm:mt-0 px-4 py-2 rounded-xl bg-white/10 border border-white/20 text-sm focus:ring-2 focus:ring-indigo-500 focus:outline-none">
      </div>

      <div class="overflow-x-auto">
        <table class="w-full text-sm">
          <thead>
            <tr class="text-left border-b border-white/10">
              <th class="pb-4 font-medium">Key</th>
              <th class="pb-4 font-medium">Macho</th>
              <th class="pb-4 font-medium">Sold By</th>
              <th class="pb-4 font-medium">Claimed</th>
              <th class="pb-4 font-medium">Expires</th>
              <th class="pb-4 font-medium">Plan</th>
              <th class="pb-4 font-medium">Status</th>
            </tr>
          </thead>
          <tbody>
            <template x-for="key in keys" :key="key.id">
              <tr class="border-b border-white/5 hover:bg-white/5 dark:hover:bg-gray-800/30 transition">
                <td class="py-4">
                  <a :href="'key.html?key=' + key.id" class="font-mono text-indigo-400 hover:underline" x-text="key.id"></a>
                </td>
                <td class="py-4" x-text="key.macho"></td>
                <td class="py-4">
                  <a :href="'reseller.html?id=' + key.reseller.id" class="hover:underline text-purple-400" x-text="key.reseller.name"></a>
                </td>
                <td class="py-4 text-gray-500" x-text="key.claimed"></td>
                <td class="py-4 text-gray-500" x-text="key.expires"></td>
                <td class="py-4 font-medium" x-text="key.plan"></td>
                <td class="py-4">
                  <span :class="key.status === 'Active' ? 'bg-green-500/20 text-green-300' : 'bg-red-500/20 text-red-300'" class="px-3 py-1 rounded-full text-xs font-medium flex items-center w-fit">
                    <i :data-feather="key.status === 'Active' ? 'check' : 'x'" class="w-3 h-3 mr-1"></i>
                    <span x-text="key.status"></span>
                  </span>
                </td>
              </tr>
            </template>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</main>

<!-- Redeem Key Modal -->
<div x-show="openRedeemModal" class="fixed inset-0 bg-black/60 backdrop-blur-xl z-50 flex items-center justify-center p-4" x-transition>
  <div class="glass p-8 rounded-3xl max-w-md w-full neon-glow">
    <div class="flex items-center justify-between mb-6">
      <h3 class="text-2xl font-bold">Redeem Your Key</h3>
      <button @click="openRedeemModal = false" class="p-2 rounded-lg hover:bg-white/10">
        <i data-feather="x" class="w-5 h-5"></i>
      </button>
    </div>
    <input x-model="redeem.key" type="text" placeholder="Enter key" class="w-full px-5 py-3 rounded-xl bg-white/10 border border-white/20 text-white placeholder-white/50 mb-4 focus:ring-2 focus:ring-indigo-500 focus:outline-none">
    <input x-model="redeem.macho" type="text" placeholder="Macho auth" class="w-full px-5 py-3 rounded-xl bg-white/10 border border-white/20 text-white placeholder-white/50 mb-6 focus:ring-2 focus:ring-indigo-500 focus:outline-none">
    <div class="flex space-x-3">
      <button @click="redeemKey()" class="flex-1 py-3 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl font-medium hover:shadow-xl neon-glow transition">
        Redeem Now
      </button>
      <button @click="openRedeemModal = false" class="flex-1 py-3 border border-gray-500 text-gray-300 rounded-xl hover:bg-gray-800/50 transition">
        Cancel
      </button>
    </div>
  </div>
</div>

<!-- Toast Notifications -->
<div class="fixed top-6 right-6 space-y-3 z-50" x-show="toasts.length">
  <template x-for="toast in toasts" :key="toast.id">
    <div x-show="toast.visible" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0 transform translate-x-4" x-transition:enter-end="opacity-100 transform translate-x-0" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" class="glass p-4 rounded-2xl shadow-xl flex items-center space-x-3 max-w-sm neon-glow">
      <i :data-feather="toast.icon" class="w-6 h-6" :class="toast.color"></i>
      <p x-text="toast.message" class="flex-1 font-medium"></p>
      <button @click="removeToast(toast.id)" class="p-1 rounded hover:bg-white/10">
        <i data-feather="x" class="w-4 h-4"></i>
      </button>
    </div>
  </template>
</div>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyA9sJoZSzbmKJ-7F9jsYVmf7m4cMJ_JUuA",
    authDomain: "captcha-finder.firebaseapp.com",
    projectId: "captcha-finder",
    storageBucket: "captcha-finder.firebasestorage.app",
    messagingSenderId: "268327722037",
    appId: "1:268327722037:web:54ba44e1d4ccc2c734e57c"
  };
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();

  function dashboard() {
    return {
      collapsed: false,
      user: null,
      injectCode: `// CapTcha Tool Inject\nconsole.log("Ready to solve!");`,
      stats: { personal: 87, global: 12407 },
      keys: [
        { id: "CT-PRO-2025", macho: "Macho#9001", reseller: { id: "r9", name: "EliteSeller" }, claimed: "2025-11-01", expires: "2026-11-01", plan: "Lifetime", status: "Active" },
        { id: "CT-DEV-001 999", macho: "Dev#001", reseller: { id: "r1", name: "Admin" }, claimed: "2025-10-20", expires: "2025-11-20", plan: "Month", status: "Active" },
        { id: "CT-OLD-001", macho: "Legacy#1", reseller: { id: "r2", name: "OldUser" }, claimed: "2025-01-01", expires: "2025-02-01", plan: "Week", status: "Expired" }
      ],
      openRedeemModal: false,
      redeem: { key: '', macho: '' },
      toasts: [],

      initAuth() {
        auth.onAuthStateChanged(user => {
          if (user) {
            this.user = user;
          } else {
            window.location.href = 'login.html';
          }
        });
      },

      copyInjectCode() {
        navigator.clipboard.writeText(this.injectCode);
        this.notify('success', 'Inject code copied to clipboard!');
      },

      redeemKey() {
        if (!this.redeem.key || !this.redeem.macho) return this.notify('danger', 'Please fill both fields');
        setTimeout(() => {
          this.openRedeemModal = false;
          this.notify('success', `Key ${this.redeem.key} redeemed!`);
          this.redeem = { key: '', macho: '' };
        }, 1000);
      },

      logout() {
        auth.signOut().then(() => window.location.href = 'index.html');
      },

      notify(type, message) {
        const id = Date.now() + Math.random();
        const icons = { success: 'check-circle', danger: 'x-circle' };
        const colors = { success: 'text-green-400', danger: 'text-red-400' };
        this.toasts.push({ id, type, message, icon: icons[type], color: colors[type], visible: true });
        setTimeout(() => this.removeToast(id), 4000);
      },

      removeToast(id) {
        const t = this.toasts.find(x => x.id === id);
        if (t) t.visible = false;
        setTimeout(() => this.toasts = this.toasts.filter(x => x.id !== id), 300);
      }
    };
  }
</script>

<!-- Tooltips for collapsed sidebar -->
<script>
  document.addEventListener('alpine:init', () => {
    Alpine.directive('tooltip', (el, { expression }) => {
      const tip = expression;
      el.setAttribute('data-tip', tip);
      el.classList.add('relative');
      el.innerHTML += `<div class="absolute left-full ml-2 top-1/2 -translate-y-1/2 bg-gray-800 text-white text-xs px-2 py-1 rounded opacity-0 pointer-events-none transition-opacity whitespace-nowrap z-10">${tip}</div>`;
      el.addEventListener('mouseenter', () => el.querySelector('div').classList.replace('opacity-0', 'opacity-100'));
      el.addEventListener('mouseleave', () => el.querySelector('div').classList.replace('opacity-100', 'opacity-0'));
    });
  });
</script>
</body>
</html>
